{%extends 'base.html'%}
<!-- Supposedly complete. TODO: change layout to a card structure -->

<!-- Context Mixins -->
<!-- 
	ProjectDetailView(GET only)
	ProjectEditView(POST only)
	User Details(contrib.auth context processor)
	TaskListView
	UpdateListView
	DocumentListView
-->

{%block content%}
<div class="read-tab-content" style="display: block;">
	<table>
		<tbody><tr>
			<td>UID 1</td>
			<td><strong>{{project.name}}</strong></td>
		</tr>
		<tr>
		<td colspan="2">
				<div class="brief-writeup"><p class="text" id="1395992530932_clone">{{project.brief}}</p></div>
			</td>
		</tr>
		<tr>
		<td colspan="2">
			<div class="detail-writeup-left"><p class="text" id="1395992530922_clone">{{project.desc}}<a href="javascript:void(0);" class="cmConstrain " title="Show Less">[ Less ]</a></p></div>
			<div class="detail-writeup-right">
				<center>
					<img src="upload/ActivityImages/bgimages/AUV Pic.jpg">
				</center>
			</div>
		</td>
		</tr>
		<tr>
			<td><strong>Status: </strong></td>
			<td><strong>Tags: </strong>
			{%for tag in project.tags%}
				{{tag.label}},
			{%endfor%}

			</td>
		</tr>
		<!--<tr> Removed as per reviewed design structure.
			<td><strong>Overall Budget: </strong>950000</td>
			<td><strong>Utilized Budget: </strong>55000</td>
		</tr>-->
	</tbody></table>
	{%if user|allow_project_edit%}
	<div class="edit-activity-btn"><div></div>Edit</div>
	{%endif%}
</div>
{%if user|allow_project_edit%}
<div class="editAcivityFormDiv" style="display: none;">

	<form name="update_activity" class="form-horizontal" action="index.php?action=update_activity" method="POST" enctype="multipart/form-data">
	<input type="hidden" class="input-xlarge" name="id" value="1"> 
	<table>
		<tbody><tr>
			<td>UID 1</td>
			<td><input type="text" class="input-xlarge" name="title" value="AUV"></td>
		</tr>
		<tr>
			<td colspan="2">
				<div class="brief-writeup"><textarea class="input-xlarge" id="textarea" rows="2" name="brief_writeup">{{project.brief}} </textarea></div>
			</td>
		</tr>
		<tr>
		<td colspan="2">
			<div class="detail-writeup-left"><textarea class="input-xlarge" id="textarea" rows="6" name="detailed_writeup">{{project.desc}}</textarea></div>
			<div class="detail-writeup-right">
				<center>
					<img src="upload/ActivityImages/bgimages/AUV Pic.jpg">
				</center>
			</div>
		</td>
		</tr>
		<tr>
			<td><strong>Status: </strong></td>
			<td><strong>Tags: </strong><input type="text" class="input-xlarge" name="tags" value="
			{%for tag in project.tags%}
				{{tag.label}},
			{%endfor%}
			" id="input01"></td>
		</tr>
		<!-- Removed on demand -->
		<!--<tr>
			<td><strong>Overall Budget: </strong><input type="text" class="input-xlarge" name="overall_budget" value="950000"></td>
			<td><strong>Utilized Budget: </strong><input type="text" class="input-xlarge" name="utilized_budget" value="55000"></td>
		</tr>-->
		<tr>
			<td><strong>Icon: </strong><input type="file" name="icon" id="exampleInputFile"></td>
			<td><strong>BG Image: </strong><input type="file" name="bgImg" id="exampleInputFile"></td>
		</tr>
	</tbody></table>
	<button type="submit" class="btn btn-primary">Save</button>
	<button type="button" class="btn btn-primary close-edit-activity-btn">Back</button>
	</form>
</div>
{%endif%}

<div class="documentsDiv">	
	<!-- Documents Secction -->
	<div class="divHeading1">Documents</div>
<table class="document-list">
	<tbody><tr>
		<td><strong>S No.</strong></td>
		<td><strong>Document Name</strong></td>
		<td><strong>Uploaded By</strong></td>
		<td><strong>Uploaded On</strong></td>
		<td><strong>Tags</strong></td>
		<td></td>
	</tr>
	
	{%for doc in documents%}
	<tr>
		<td>{{doc.index}}</td>
		<td><a target="_blank" href="{{doc.doc.url}}">{{doc.doc.name}}</a></td>
		<td>{{doc.user.username}}</td>
		<td>{{doc.timestamp}}</td>
		<td class="file-tag" id="1395992530936" style="display: table-cell;">{{doc.desc}}</td>
		<td><a class="delete-doc-link" href="{{url 'project:deletefile' doc.pk}}">Delete</a></td>
	</tr>
	{%endfor%}

</tbody></table>

<div class="divHeading2">Upload a new document</div>
<form name="addDocument" action="#" enctype="multipart/form-data" method="POST">
	<table>
		<tbody><tr>
			<td><strong>File:</strong> <input type="file" name="docName"></td>
			<td style="max-width:200px;"><strong>Tags:	</strong> <input type="text" name="tags" placeholder="Enter File Tags"></td>
			<td><input type="hidden" name="activityId" value="1"><input type="submit" value="Upload"></td>
		</tr>
	</tbody></table>
</form>


</div>

<script>
	$('.editAcivityFormDiv').fadeOut(0);
	$('.detail-writeup-left>.text').cmtextconstrain({
		event: 'click', 
		onExpose: function(){}, 
		onConstrain: function(){}, 
		restrict: {type: 'words', limit: 60}, 
		showControl: {string: '[ More ]', title: 'Show More', addclass: ''}, 
		hideControl: {string: '[ Less ]', title: 'Show Less', addclass: ''}, 
		trailingString: '....'
    });
	$('.brief-writeup>.text').cmtextconstrain({
		event: 'click', 
		onExpose: function(){}, 
		onConstrain: function(){}, 
		restrict: {type: 'words', limit: 30}, 
		showControl: {string: '[ More ]', title: 'Show More', addclass: ''}, 
		hideControl: {string: '[ Less ]', title: 'Show Less', addclass: ''}, 
		trailingString: '....'
    });
	$('.documentsDiv table .file-tag').cmtextconstrain({
		event: 'click', 
		onExpose: function(){}, 
		onConstrain: function(){}, 
		restrict: {type: 'words', limit: 4}, 
		showControl: {string: '[ More ]', title: 'Show More', addclass: ''}, 
		hideControl: {string: '[ Less ]', title: 'Show Less', addclass: ''}, 
		trailingString: '....'
    });
	$('.edit-activity-btn').click(function(){
		$('.read-tab-content').fadeOut(0);
		$('.editAcivityFormDiv').fadeIn(100);
	});
	$('.close-edit-activity-btn').click(function(){
		$('.read-tab-content').fadeIn(100);
		$('.editAcivityFormDiv').fadeOut(0);
	});
</script>